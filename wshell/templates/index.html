{% extends 'base.html' %}
{% block content %}
{% load staticfiles %}
    <div class="king-layout2-main mt15" style="width:960px;" xmlns="http://www.w3.org/1999/html">
            <div class="container-fluid mb0 ">
                <br class="row">
<div id="chart4_demo1" style="height: 500px; padding: 10px; -webkit-tap-highlight-color: transparent; user-select: none; background-color: rgba(0, 0, 0, 0); cursor: default;" _echarts_instance_="1588993853145">
    <div style="position: relative; overflow: hidden; width: 1099px; height: 500px;">
        <div data-zr-dom-id="bg" class="zr-element" style="position: absolute; left: 0px; top: 0px; width: 1099px; height: 500px; user-select: none;"></div>
        <canvas width="1099" height="500" data-zr-dom-id="0" class="zr-element" style="position: absolute; left: 0px; top: 0px; width: 1099px; height: 500px; user-select: none; -webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></canvas>
        <canvas width="1099" height="500" data-zr-dom-id="1" class="zr-element" style="position: absolute; left: 0px; top: 0px; width: 1099px; height: 500px; user-select: none; -webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></canvas>
        <canvas width="1099" height="500" data-zr-dom-id="_zrender_hover_" class="zr-element" style="position: absolute; left: 0px; top: 0px; width: 1099px; height: 500px; user-select: none; -webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></canvas>
        <div class="echarts-dataview" style="position: absolute; display: block; overflow: hidden; transition: height 0.8s ease 0s, background-color 1s ease 0s; z-index: 1; left: 0px; top: 0px; width: 1099px; height: 0px; background-color: rgb(240, 255, 255);">
            <p style="padding:8px 0;margin:0 0 10px 0;border-bottom:1px solid #eee">数据视图</p>
            <textarea style="display: block; margin: 0px 0px 8px; padding: 4px 6px; overflow: auto; width: 100%; height: 400px; cursor: default;"></textarea>
            <button type="button" style="float: right; padding: 1px 6px;">关闭</button>
            <button type="button" style="float: right; margin-right: 10px; padding: 1px 6px;">刷新</button>
        </div>
        <div class="echarts-tooltip zr-element" style="position: absolute; display: none; border-style: solid; white-space: nowrap; transition: left 0.4s ease 0s, top 0.4s ease 0s; background-color: rgba(0, 0, 0, 0.7); border-width: 0px; border-color: rgb(51, 51, 51); border-radius: 4px; color: rgb(255, 255, 255); padding: 5px; left: 708px; top: 120px;">访问来源
            <br>邮件营销 : 310 (12.10%)</div>
    </div>
</div>
                </br>
                </br>
        <div id="chart9_demo1" style="height: 500px; padding: 10px; -webkit-tap-highlight-color: transparent; user-select: none; background-color: rgba(0, 0, 0, 0);" _echarts_instance_="1588994863298">
        <div style="position: relative; overflow: hidden; width: 969px; height: 500px;">
        <div data-zr-dom-id="bg" class="zr-element" style="position: absolute; left: 0px; top: 0px; width: 969px; height: 500px; user-select: none;"></div>
        <canvas width="969" height="500" data-zr-dom-id="0" class="zr-element" style="position: absolute; left: 0px; top: 0px; width: 969px; height: 500px; user-select: none; -webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></canvas>
        <canvas width="969" height="500" data-zr-dom-id="1" class="zr-element" style="position: absolute; left: 0px; top: 0px; width: 969px; height: 500px; user-select: none; -webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></canvas>
        <canvas width="969" height="500" data-zr-dom-id="_zrender_hover_" class="zr-element" style="position: absolute; left: 0px; top: 0px; width: 969px; height: 500px; user-select: none; -webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></canvas>
        <div class="echarts-dataview" style="position: absolute; display: block; overflow: hidden; transition: height 0.8s ease 0s, background-color 1s ease 0s; z-index: 1; left: 0px; top: 0px; width: 969px; height: 0px; background-color: rgb(240, 255, 255);"></div>
    </div>
  </div>
                    </div>
                </div>
        </div>
    </div>
</body>
<script type="text/javascript">
    function createEPieChart(conf){
        var myChart = echarts.init(document.getElementById(conf.selector));
        var aLegend = [];
        var series = conf.data.series;
        for (var i = 0; i < series.length; i++) {
             aLegend[i] = series[i].name;
        };
        // 填入数据
        myChart.setOption({
            title : {
                text: conf.data.title,
                subtext: '',
                x:'center'
            },
            legend: {
                // x : 'left',
                y: 'bottom',
                data: aLegend
            },
            tooltip : {
                trigger: 'item',
                formatter: "{a} <br/>{b} : {c} ({d}%)"
            },
            toolbox: {
                show : true,
                feature : {
                    mark : {show: true},
                    dataView : {show: true, readOnly: false},
                    magicType : {
                        show: true,
                        type: ['pie', 'funnel'],
                        option: {
                            funnel: {
                                x: '25%',
                                width: '50%',
                                funnelAlign: 'left',
                                max: 1548
                            }
                        }
                    },
                    restore : {show: true},
                    saveAsImage : {show: true}
                }
            },
            calculable : true,
            series: [{
                // 根据名字对应到相应的系列
                name:'访问来源',
                type:'pie',
                data: series
            }]
        });
    }

    function initEPieChart(conf){
        $.ajax({
            url: conf.url,
            type: 'GET',
            dataType: conf.dataType,
            success: function(res){
                //获取数据成功
                if (res.result){
                    var data = res.data;
                    createEPieChart({
                        selector: conf.containerId, // 图表容器
                        data: data, // 图表数据
                    });
                }
            }
        });
    }

    $(function(){
        initEPieChart({
            url: 'https://magicbox.bk.tencent.com/static_api/v3/components/chart4/demo.json',
            dataType: 'json',
            containerId: 'chart4_demo1'
        });
    });
    function createERingPieChart(conf){
        var myChart = echarts.init(document.getElementById(conf.selector));
        var aLegend = [];
        var seriesdata = conf.data.series;
        for (var i = 0; i < seriesdata.length; i++) {
             aLegend[i] = seriesdata[i].name;
         };
        // 填入数据
        myChart.setOption({
            title : {
                text: conf.data.title,
                subtext: '',
                x:'center'
            },
            legend: {
                orient : 'vertical',
                x : 'left',
                data:aLegend
            },
            tooltip : {
                trigger: 'item',
                formatter: "{a} <br/>{b} : {c} ({d}%)"
            },
            toolbox: {
                show : true,
                feature : {
                    mark : {show: true},
                    dataView : {show: true, readOnly: false},
                    magicType : {
                        show: true,
                        type: ['pie', 'funnel'],
                        option: {
                            funnel: {
                                x: '25%',
                                width: '50%',
                                funnelAlign: 'center',
                                max: 1548
                            }
                        }
                    },
                    restore : {show: true},
                    saveAsImage : {show: true}
                }
            },
            calculable : true,
            series: [{
                // 根据名字对应到相应的系列
                name:'访问来源',
                type:'pie',
                radius : ['50%', '70%'],
                itemStyle : {
                    normal : {
                        label : {
                            show : false
                        },
                        labelLine : {
                            show : false
                        }
                    },
                    emphasis : {
                        label : {
                            show : true,
                            position : 'center',
                            textStyle : {
                                fontSize : '30',
                                fontWeight : 'bold'
                            }
                        }
                    }
                },
                data: seriesdata
            }]
        });
    }
    function initERingPieChart(conf){
        $.ajax({
            url: conf.url,
            type: 'GET',
            dataType: conf.dataType,
            success: function(res){
                //获取数据成功
                if (res.result){
                    var data = res.data;
                    createERingPieChart({
                        selector: conf.containerId, // 图表容器
                        data: data, // 图表数据
                    });
                }
            }
        })
    }
    $(function(){
        initERingPieChart({
            url: 'http://127.0.0.1:8000/static/demo/demo.json',
            dataType: 'json',
            containerId: 'chart9_demo1'
        });
    });
</script>

{% endblock %}